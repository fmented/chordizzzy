function setLow(e){lo=e,t.innerHTML="Press the highest note"}function setHigh(e){t.className="txt",t.innerHTML="Generating Chord list",nav.className="navbar-anim",setTimeout(function(){hi=e,chord=getChordList()},4e3)}function onFailed(){t.innerHTML="This Browser Doesn't Support MIDI"}function compare(e,n){if(e.toString()==n.toString())return!0}function onMIDISuccess(e){for(var n of e.inputs.values())n.onstatechange=function(){init(),"open"==this.connection?(lo=void 0,hi=void 0,t.innerHTML="Press the lowest note"):(inputDev.splice(inputDev.indexOf(n.name),1),setTimeout(function(){inputDev.length<1&&(t.innerHTML="No MIDI Device")},100))},n.onmidimessage=getMIDIMessage}function init(){inputDev.length<1?t.innerHTML="No MIDI Device":t.innerHTML="Press the lowest note"}function getChordList(){var e,n,a,s,m,o,y,k,i,d={};return chords.forEach(function(t){for(var r=lo;r<hi;r++){var l=add(t.keys,r);e=l[1]+t.name,n=l[0],Math.max(...n)<=hi&&(null==d[n]?d[n]=[e]:d[n].includes(e)||d[n].push(e));for(var M=lo;M<=hi;M++)if(M<r){if(M%12!=r%12){l=addSlash(t.keys,r,M);e=l[1]+t.name+"/"+l[2],n=l[0],Math.max(...n)<=hi&&(null==d[n]?d[n]=[e]:d[n].includes(e)||d[n].push(e))}chords.forEach(l=>{a=l.keys,s=add(a,M),m=add(t.keys,r),o=s[0],k=s[1],y=m[0],i=m[1],n=o.concat(y).sort(function(e,n){return e-n}),e=i+t.name+"/"+k+l.name,Math.max(...n)<=hi&&(null==d[n]?d[n]=[e]:d[n].includes(e)||d[n].push(e))})}}}),t.className="",nav.className="",t.innerHTML="Ready",d}function getMIDIMessage(e){var n=e.data[1];144==e.data[0]?null==lo&&null==hi?setLow(n):null!=lo&&null==hi?setHigh(n):(played.push(n),play(n),1==played.length?n<=hi&&n>=lo&&(t.innerHTML=notes[n%12]):(p=played.sort(function(e,n){return e-n}),null!=chord[p.toString()]&&(chord[p.toString()].length>1?(t.innerHTML=filter(chord[p.toString()]),alt.innerHTML=render(t.innerHTML,chord[p.toString()])):t.innerHTML=chord[p.toString()][0]))):(release(n),played.splice(played.indexOf(n),1),null!=hi&&null!=lo&&(t.innerHTML="",alt.innerHTML=""))}function add(e,n){for(var a=[],s=0;s<e.length;s++)a.push(e[s]+n);return[a.sort(function(e,n){return e-n}),notes[Math.floor(n%12)]]}function addSlash(e,n,a){for(var s=[],m=0;m<e.length;m++)s.push(e[m]+n);return s.sort(function(e,n){return e-n}),s.unshift(a),[s,notes[Math.floor(n%12)],notes[Math.floor(a%12)]]}function play(e){e>=lo&&e<=hi&&(synth.triggerAttack(notes[e%12]+Math.floor(e/12),0),synth2.triggerAttack(notes[e%12]+(Math.floor(e/12)-1),0))}function release(e){e>=lo&&e<=hi&&(synth.triggerRelease(notes[e%12]+Math.floor(e/12),1),synth2.triggerRelease(notes[e%12]+(Math.floor(e/12)-1),1))}function smallest(e){for(var n,a,s=0;s<e.length;s++)0==s?(n=e[s].length,a=e[s]):e[s].length<n&&(n=e[s].length,a=e[s]);return a}function render(e,n){for(var a="<ul><li><b>Alt :</b></li>",s=0;s<n.length;s++)n[s]!=e&&(s==n.length-1?a+="<li><b>"+n[s]+"</b></li>":a+="<li><b>"+n[s]+",</b></li>");return a+="</ul>",a}function filter(e){for(var n=[],a=[],s=[],m=0;m<e.length;m++)e[m].includes("/")?s.push(e[m]):e[m].includes("(no")?a.push(e[m]):e[m].includes("(no")&&e[m].includes("/")?s.push(e[m]):n.push(e[m]);return n.length>0?smallest(n):a.length>0?smallest(a):smallest(s)}var chord,lo,hi,midisupport,tm,p,t=document.getElementById("txt"),alt=document.getElementById("alt"),nav=document.getElementById("navbar"),played=[],notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],inputDev=[];const synth=new Tone.PolySynth({polyphony:2,voice:Tone.Synth}).toDestination(),synth2=new Tone.PolySynth({polyphony:2,voice:Tone.Synth}).toDestination();nav.onclick=function(){"running"!==Tone.context.state?Tone.context.resume():Tone.start()};var chords=[{name:"M",keys:[0,4,7]},{name:"-5",keys:[0,4,6]},{name:"Aug",keys:[0,4,8]},{name:"(add2)",keys:[0,2,4,7]},{name:"(add4)",keys:[0,4,5,7]},{name:"(add-5)",keys:[0,4,6,7]},{name:"(add+5)",keys:[0,4,7,8]},{name:"(add9)",keys:[0,4,7,14]},{name:"(add11)",keys:[0,4,7,17]},{name:"(add13)",keys:[0,4,7,21]},{name:"-5(add2)",keys:[0,2,4,6]},{name:"-5(add4)",keys:[0,4,5,6]},{name:"-5(add+5)",keys:[0,4,6,8]},{name:"-5(add9)",keys:[0,4,6,14]},{name:"-5(add11)",keys:[0,4,6,17]},{name:"-5(add13)",keys:[0,4,6,21]},{name:"Aug(add2)",keys:[0,2,4,8]},{name:"Aug(add4)",keys:[0,4,5,8]},{name:"Aug(add-5)",keys:[0,4,6,8]},{name:"Aug(add9)",keys:[0,4,8,14]},{name:"Aug(add11)",keys:[0,4,8,17]},{name:"Aug(add13)",keys:[0,4,8,21]},{name:"6",keys:[0,4,7,9]},{name:"M7",keys:[0,4,7,11]},{name:"M9",keys:[0,4,7,11,14]},{name:"M11",keys:[0,4,7,11,14,17]},{name:"M13",keys:[0,4,7,11,14,17,21]},{name:"M6-5",keys:[0,4,6,9]},{name:"M7-5",keys:[0,4,6,11]},{name:"M9-5",keys:[0,4,6,11,14]},{name:"M11-5",keys:[0,4,6,11,14,17]},{name:"M13-5",keys:[0,4,6,11,14,17,21]},{name:"M6+5",keys:[0,4,8,9]},{name:"M7+5",keys:[0,4,8,11]},{name:"M9+5",keys:[0,4,8,11,14]},{name:"M11+5",keys:[0,4,8,11,14,17]},{name:"M13+5",keys:[0,4,8,11,14,17,21]},{name:"7",keys:[0,4,7,10]},{name:"9",keys:[0,4,7,10,14]},{name:"11",keys:[0,4,7,10,14,17]},{name:"13",keys:[0,4,7,10,14,17,21]},{name:"7-5",keys:[0,4,6,10]},{name:"9-5",keys:[0,4,6,10,14]},{name:"11-5",keys:[0,4,6,10,14,17]},{name:"13-5",keys:[0,4,6,10,14,17,21]},{name:"7+5",keys:[0,4,8,10]},{name:"9+5",keys:[0,4,8,10,14]},{name:"11+5",keys:[0,4,8,10,14,17]},{name:"13+5",keys:[0,4,8,10,14,17,21]},{name:"m",keys:[0,3,7]},{name:"m+5",keys:[0,3,8]},{name:"m(add2)",keys:[0,2,3,7]},{name:"m(add4)",keys:[0,3,5,7]},{name:"m(add-5)",keys:[0,3,6,7]},{name:"m(add+5)",keys:[0,3,7,8]},{name:"m(add9)",keys:[0,3,7,14]},{name:"m(add11)",keys:[0,3,7,17]},{name:"m(add13)",keys:[0,3,7,21]},{name:"m-5(add2)",keys:[0,2,3,6]},{name:"m-5(add4)",keys:[0,3,5,6]},{name:"m-5(add+5)",keys:[0,3,6,8]},{name:"m-5(add9)",keys:[0,3,6,14]},{name:"m-5(add11)",keys:[0,3,6,17]},{name:"m-5(add13)",keys:[0,3,6,21]},{name:"m+5(add2)",keys:[0,2,3,8]},{name:"m+5(add4)",keys:[0,3,5,8]},{name:"m+5(add-5)",keys:[0,3,6,8]},{name:"m+5(add9)",keys:[0,3,8,14]},{name:"m+5(add11)",keys:[0,3,8,17]},{name:"m+5(add13)",keys:[0,3,8,21]},{name:"m6",keys:[0,3,7,9]},{name:"mM7",keys:[0,3,7,11]},{name:"mM9",keys:[0,3,7,11,14]},{name:"mM11",keys:[0,3,7,11,14,17]},{name:"mM13",keys:[0,3,7,11,14,17,21]},{name:"mM6-5",keys:[0,3,6,9]},{name:"mM7-5",keys:[0,3,6,11]},{name:"mM9-5",keys:[0,3,6,11,14]},{name:"mM11-5",keys:[0,3,6,11,14,17]},{name:"mM13-5",keys:[0,3,6,11,14,17,21]},{name:"mM6+5",keys:[0,3,8,9]},{name:"mM7+5",keys:[0,3,8,11]},{name:"mM9+5",keys:[0,3,8,11,14]},{name:"mM11+5",keys:[0,3,8,11,14,17]},{name:"mM13+5",keys:[0,3,8,11,14,17,21]},{name:"m7",keys:[0,3,7,10]},{name:"m9",keys:[0,3,7,10,14]},{name:"m11",keys:[0,3,7,10,14,17]},{name:"m13",keys:[0,3,7,10,14,17,21]},{name:"m7-5",keys:[0,3,6,10]},{name:"m9-5",keys:[0,3,6,10,14]},{name:"m11-5",keys:[0,3,6,10,14,17]},{name:"m13-5",keys:[0,3,6,10,14,17,21]},{name:"m7+5",keys:[0,3,8,10]},{name:"m9+5",keys:[0,3,8,10,14]},{name:"m11+5",keys:[0,3,8,10,14,17]},{name:"m13+5",keys:[0,3,8,10,14,17,21]},{name:"sus2",keys:[0,2,7]},{name:"sus4",keys:[0,5,7]},{name:"°",keys:[0,3,6]},{name:"°7",keys:[0,3,6,9]},{name:"°9",keys:[0,3,6,9,14]},{name:"°11",keys:[0,3,6,9,14,17]},{name:"°13",keys:[0,3,6,9,14,17,21]},{name:"𝆩7",keys:[0,3,6,10]},{name:"𝆩9",keys:[0,3,6,10,14]},{name:"𝆩11",keys:[0,3,6,10,14,17]},{name:"𝆩13",keys:[0,3,6,10,14,17,21]},{name:"6/9",keys:[0,4,7,9,14]},{name:"6/11",keys:[0,4,7,9,17]},{name:"6/13",keys:[0,4,7,9,21]},{name:"m6/9",keys:[0,3,7,9,14]},{name:"m6/11",keys:[0,3,7,9,17]},{name:"m6/13",keys:[0,3,7,9,21]},{name:"M(no5)",keys:[0,4]},{name:"6(no5)",keys:[0,4,9]},{name:"M7(no5)",keys:[0,4,11]},{name:"M9(no5)",keys:[0,4,11,14]},{name:"M11(no5)",keys:[0,4,11,14,17]},{name:"M13(no5)",keys:[0,4,11,14,17,21]},{name:"7(no5)",keys:[0,4,10]},{name:"9(no5)",keys:[0,4,10,14]},{name:"11(no5)",keys:[0,4,10,14,17]},{name:"13(no5)",keys:[0,4,10,14,17,21]},{name:"m(no5)",keys:[0,3]},{name:"m6(no5)",keys:[0,3,9]},{name:"mM7(no5)",keys:[0,3,11]},{name:"mM9(no5)",keys:[0,3,11,14]},{name:"mM11(no5)",keys:[0,3,11,14,17]},{name:"mM13(no5)",keys:[0,3,11,14,17,21]},{name:"m7(no5)",keys:[0,3,10]},{name:"m9(no5)",keys:[0,3,10,14]},{name:"m11(no5)",keys:[0,3,10,14,17]},{name:"m13(no5)",keys:[0,3,10,14,17,21]},{name:"sus2(no5)",keys:[0,2]},{name:"sus4(no5)",keys:[0,5]},{name:"6/9(no5)",keys:[0,4,9,14]},{name:"6/11(no5)",keys:[0,4,9,17]},{name:"6/13(no5)",keys:[0,4,9,21]},{name:"m6/9(no5)",keys:[0,3,9,14]},{name:"m6/11(no5)",keys:[0,3,9,17]},{name:"m6/13(no5)",keys:[0,3,9,21]},{name:"M9(no7)",keys:[0,4,7,14]},{name:"M11(no7)",keys:[0,4,7,14,17]},{name:"M13(no7)",keys:[0,4,7,14,17,21]},{name:"M9-5(no7)",keys:[0,4,6,14]},{name:"M11-5(no7)",keys:[0,4,6,14,17]},{name:"M13-5(no7)",keys:[0,4,6,14,17,21]},{name:"M9+5(no7)",keys:[0,4,8,14]},{name:"M11+5(no7)",keys:[0,4,8,14,17]},{name:"M13+5(no7)",keys:[0,4,8,14,17,21]},{name:"mM9(no7)",keys:[0,3,7,14]},{name:"mM11(no7)",keys:[0,3,7,14,17]},{name:"mM13(no7)",keys:[0,3,7,14,17,21]},{name:"mM9-5(no7)",keys:[0,3,6,14]},{name:"mM11-5(no7)",keys:[0,3,6,14,17]},{name:"mM13-5(no7)",keys:[0,3,6,14,17,21]},{name:"mM9+5(no7)",keys:[0,3,8,14]},{name:"mM11+5(no7)",keys:[0,3,8,14,17]},{name:"mM13+5(no7)",keys:[0,3,8,14,17,21]},{name:"M9(no5)(no7)",keys:[0,4,14]},{name:"M11(no5)(no7)",keys:[0,4,14,17]},{name:"M13(no5)(no7)",keys:[0,4,14,17,21]},{name:"mM9(no5)(no7)",keys:[0,3,14]},{name:"mM11(no5)(no7)",keys:[0,3,14,17]},{name:"mM13(no5)(no7)",keys:[0,3,14,17,21]}];init(),navigator.permissions.query({name:"midi"}).then(e=>{"granted"==e.state&&navigator.requestMIDIAccess().then(onMIDISuccess,onFailed)});