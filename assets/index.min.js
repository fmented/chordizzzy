function setLow(e){lo=e,t.innerHTML="Press the highest note"}function setHigh(e){t.className="txt",t.innerHTML="Generating Chord list",nav.className="navbar-anim",setTimeout(function(){hi=e,chord=getChordList()},4e3)}function onFailed(){t.innerHTML="This Browser Doesn't Support MIDI"}function compare(e,n){if(e.toString()==n.toString())return!0}function onMIDISuccess(e){for(var n of e.inputs.values())n.onstatechange=function(){init(),"open"==this.connection?(lo=void 0,hi=void 0,t.innerHTML="Press the lowest note"):(inputDev.splice(inputDev.indexOf(n.name),1),setTimeout(function(){inputDev.length<1&&(t.innerHTML="No MIDI Device")},100))},n.onmidimessage=getMIDIMessage}function init(){inputDev.length<1?t.innerHTML="No MIDI Device":t.innerHTML="Press the lowest note"}function getChordList(){var e,n,a,s,m,o,y,i,k,r={};return chords.forEach(function(t){for(var u=lo;u<hi;u++){var l=add(t.keys,u);e=l[1]+t.name,n=l[0],Math.max(...n)<=hi&&null==r[n]&&(r[n]=e);for(var d=lo;d<=hi;d++)if(d<u){if(d%12!=u%12){l=addSlash(t.keys,u,d);e=l[1]+t.name+"/"+l[2],n=l[0],Math.max(...n)<=hi&&null==r[n]&&(r[n]=e)}chords.forEach(l=>{a=l.keys,s=add(a,d),m=add(t.keys,u),o=s[0],i=s[1],y=m[0],k=m[1],n=o.concat(y).sort(function(e,n){return e-n}),e=k+t.name+"/"+i+l.name,Math.max(...n)<=hi&&null==r[n]&&(r[n]=e)})}}}),t.className="",nav.className="",t.innerHTML="Ready",r}function getMIDIMessage(e){var n=e.data[1];if(144==e.data[0]){if(null==lo&&null==hi)setLow(n);else if(null!=lo&&null==hi)setHigh(n);else if(played.push(n),1==played.length)setTimeout(()=>{played[0]<=hi&&(t.innerHTML=notes[played[0]%12])},5);else if(p=played.sort(function(e,n){return e-n}),null!=chord[p.toString()]){t.innerHTML=chord[p.toString()];try{clearTimeout(tm)}catch(e){console.log(e)}}}else played.splice(played.indexOf(n),1),null!=hi&&null!=lo&&(t.innerHTML="")}function add(e,n){for(var a=[],s=0;s<e.length;s++)a.push(e[s]+n);return[a.sort(function(e,n){return e-n}),notes[Math.floor(n%12)]]}function addSlash(e,n,a){for(var s=[],m=0;m<e.length;m++)s.push(e[m]+n);return s.sort(function(e,n){return e-n}),s.unshift(a),[s,notes[Math.floor(n%12)],notes[Math.floor(a%12)]]}var chord,lo,hi,midisupport,tm,p,t=document.getElementById("txt"),nav=document.getElementById("navbar"),played=[],notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],inputDev=[],chords=[{name:"M",keys:[0,4,7]},{name:"Maj7",keys:[0,4,7,11]},{name:"Maj9",keys:[0,4,7,11,14]},{name:"Maj9",keys:[0,2,4,7,11]},{name:"6",keys:[0,4,7,9]},{name:"6/9",keys:[0,4,7,9,14]},{name:"6/9",keys:[0,2,4,7,9]},{name:"Maj7#11",keys:[0,4,6,7,11]},{name:"Maj7#11",keys:[0,4,7,11,18]},{name:"Maj13",keys:[0,4,7,11,21]},{name:"Maj13",keys:[0,4,7,9,11]},{name:"m",keys:[0,3,7]},{name:"minMaj7",keys:[0,3,7,11]},{name:"min9",keys:[0,3,7,11,13]},{name:"min9",keys:[0,2,3,7,11]},{name:"m6",keys:[0,3,7,9]},{name:"m6/9",keys:[0,3,7,9,13]},{name:"m6/9",keys:[0,2,3,7,9]},{name:"min7#11",keys:[0,3,6,7,11]},{name:"min7#11",keys:[0,3,7,11,18]},{name:"min13",keys:[0,3,7,11,21]},{name:"min13",keys:[0,3,7,9,11]},{name:"7",keys:[0,4,7,10]},{name:"m7",keys:[0,3,7,10]},{name:"sus2",keys:[0,2,7]},{name:"sus4",keys:[0,5,7]},{name:"add9",keys:[0,4,7,14]},{name:"add9",keys:[0,2,4,7]},{name:"5",keys:[0,7]},{name:"Dim",keys:[0,3,6]},{name:"Aug",keys:[0,4,8]},{name:"M-5",keys:[0,4,6]},{name:"Maj7-5",keys:[0,4,6,11]},{name:"Maj9-5",keys:[0,4,6,11,14]},{name:"Maj9-5",keys:[0,2,4,6,11]},{name:"6-5",keys:[0,4,6,9]},{name:"6/9-5",keys:[0,4,6,9,14]},{name:"6/9-5",keys:[0,2,4,6,9]},{name:"Maj13-5",keys:[0,4,6,11,21]},{name:"Maj13-5",keys:[0,4,6,9,11]},{name:"m-5",keys:[0,3,6]},{name:"minMaj7-5",keys:[0,3,6,11]},{name:"min9-5",keys:[0,3,6,11,13]},{name:"min9-5",keys:[0,2,3,6,11]},{name:"m6-5",keys:[0,3,6,9]},{name:"m6/9-5",keys:[0,3,6,9,13]},{name:"m6/9-5",keys:[0,2,3,6,9]},{name:"min13-5",keys:[0,3,6,11,21]},{name:"min13-5",keys:[0,3,6,9,11]},{name:"7-5",keys:[0,4,6,10]},{name:"m7-5",keys:[0,3,6,10]},{name:"sus2-5",keys:[0,2,6]},{name:"sus4-5",keys:[0,5,6]},{name:"add9-5",keys:[0,4,6,14]},{name:"add9-5",keys:[0,2,4,6]},{name:"M+5",keys:[0,4,8]},{name:"Maj7+5",keys:[0,4,8,11]},{name:"Maj9+5",keys:[0,4,8,11,14]},{name:"Maj9+5",keys:[0,2,4,8,11]},{name:"6+5",keys:[0,4,8,9]},{name:"6/9+5",keys:[0,4,8,9,14]},{name:"6/9+5",keys:[0,2,4,8,9]},{name:"Maj13+5",keys:[0,4,8,11,21]},{name:"Maj13+5",keys:[0,4,8,9,11]},{name:"m+5",keys:[0,3,8]},{name:"minMaj7+5",keys:[0,3,8,11]},{name:"min9+5",keys:[0,3,8,11,13]},{name:"min9+5",keys:[0,2,3,8,11]},{name:"m6+5",keys:[0,3,8,9]},{name:"m6/9+5",keys:[0,3,8,9,13]},{name:"m6/9+5",keys:[0,2,3,8,9]},{name:"min13+5",keys:[0,3,8,11,21]},{name:"min13+5",keys:[0,3,8,9,11]},{name:"7+5",keys:[0,4,8,10]},{name:"m7+5",keys:[0,3,8,10]},{name:"sus2+5",keys:[0,2,8]},{name:"sus4+5",keys:[0,5,8]},{name:"add9+5",keys:[0,4,8,14]},{name:"add9+5",keys:[0,2,4,8]},{name:"M(no5)",keys:[0,4]},{name:"Maj7(no5)",keys:[0,4,11]},{name:"Maj9(no5)",keys:[0,4,11,14]},{name:"Maj9(no5)",keys:[0,2,4,11]},{name:"6(no5)",keys:[0,4,9]},{name:"6/9(no5)",keys:[0,4,9,14]},{name:"6/9(no5)",keys:[0,2,4,9]},{name:"Maj13(no5)",keys:[0,4,11,21]},{name:"Maj13(no5)",keys:[0,4,9,11]},{name:"m(no5)",keys:[0,3]},{name:"minMaj7(no5)",keys:[0,3,11]},{name:"min9(no5)",keys:[0,3,11,13]},{name:"min9(no5)",keys:[0,2,3,11]},{name:"m6(no5)",keys:[0,3,9]},{name:"m6/9(no5)",keys:[0,3,9,13]},{name:"m6/9(no5)",keys:[0,2,3,9]},{name:"min13(no5)",keys:[0,3,11,21]},{name:"min13(no5)",keys:[0,3,9,11]},{name:"7(no5)",keys:[0,4,10]},{name:"m7(no5)",keys:[0,3,10]},{name:"sus2(no5)",keys:[0,2]},{name:"sus4(no5)",keys:[0,5]},{name:"add9(no5)",keys:[0,4,14]},{name:"add9(no5)",keys:[0,2,4]},{name:"M9(no7)",keys:[0,4,7,14]},{name:"M9(no7)",keys:[0,2,4,7]},{name:"Maj7#11(no7)",keys:[0,4,6,7]},{name:"Maj7#11(no7)",keys:[0,4,7,18]},{name:"Maj13(no7)",keys:[0,4,7,21]},{name:"Maj13(no7)",keys:[0,4,7,9]},{name:"m9(no7)",keys:[0,3,7,14]},{name:"m9(no7)",keys:[0,2,3,7]},{name:"min7#11(no7)",keys:[0,3,6,7]},{name:"min7#11(no7)",keys:[0,3,7,18]},{name:"min13(no7)",keys:[0,3,7,21]},{name:"min13(no7)",keys:[0,3,7,9]}];init(),navigator.permissions.query({name:"midi"}).then(e=>{"granted"==e.state&&navigator.requestMIDIAccess().then(onMIDISuccess,onFailed)});